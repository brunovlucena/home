apiVersion: networking.istio.io/v1beta1
kind: Gateway
metadata:
  name: flagger-gateway
  namespace: flagger-system
spec:
  # ğŸš¦ Gateway Configuration for Blue/Green Deployments
  # ğŸ¯ Traffic Management and Load Balancing
  
  # ğŸ”§ Selector for Istio Ingress Gateway
  selector:
    istio: ingressgateway
  
  # ğŸŒ Server Configuration
  servers:
  # ğŸ”µ HTTP Traffic (Port 80)
  - port:
      number: 80
      name: http
      protocol: HTTP
    hosts:
    - "bruno.dev.local"
    - "*.bruno.dev.local"
    - "flagger.bruno.dev.local"
    tls:
      httpsRedirect: true
  
  # ğŸŸ¢ HTTPS Traffic (Port 443)
  - port:
      number: 443
      name: https
      protocol: HTTPS
    hosts:
    - "bruno.dev.local"
    - "*.bruno.dev.local"
    - "flagger.bruno.dev.local"
    tls:
      mode: SIMPLE
      credentialName: bruno-tls-cert
      # ğŸ” TLS Configuration
      # ğŸ“ Note: Requires cert-manager certificate
      # ğŸ¯ Auto-generated certificate for *.bruno.dev.local
  
  # ğŸ” Health Check Endpoint
  - port:
      number: 8080
      name: health
      protocol: HTTP
    hosts:
    - "health.bruno.dev.local"
    tls:
      httpsRedirect: false
